/**
 * Navigation v1.3.0
 * (c) Graham Mendick - http://grahammendick.github.io/navigation/
 * License: Apache License 2.0
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Navigation=t()}}(function(){return function t(e,r,n){function a(o,s){if(!r[o]){if(!e[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=r[o]={exports:{}};e[o][0].call(h.exports,function(t){var r=e[o][1][t];return a(r?r:t)},h,h.exports,t,e,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(t,e,r){var n=t("./NavigationData"),a=function(){function t(t,e,r,a){this.data=t?t:{},this.state=e,this.last=a,this.title=e.title,this.navigationLink=r,n.setDefaults(this.data,this.state.defaults)}return t}();e.exports=a},{"./NavigationData":5}],2:[function(t,e,r){var n=t("./Crumb"),a=t("./NavigationData"),i=t("./ReturnDataManager"),o=t("./settings"),s=t("./StateContext"),u=t("./config/StateInfoConfig"),l=function(){function t(){}return t.buildCrumbTrail=function(t){var e=this.getCrumbs(!1);t&&e.push(new n(s.previousData,s.previousState,this.getHref(s.previousState,s.previousData,null),!1)),e=s.state.stateHandler.truncateCrumbTrail(s.state,e),o.combineCrumbTrail&&e.push(new n(s.data,s.state,this.getHref(s.state,s.data,null),!1)),e.reverse();for(var r="",a=0;a<e.length;a++)r+=this.CRUMB_1_SEP+e[a].state.id+this.CRUMB_2_SEP,r+=i.formatReturnData(e[a].state,e[a].data);this.crumbTrail=r?r:null,this.crumbTrailKey=o.crumbTrailPersister.save(this.crumbTrail)},t.getCrumbs=function(t,e){for(var r=[],a=0,o=this.crumbTrail,s=o?o.split(this.CRUMB_1_SEP).length-1:0,u=!0;s>a;){var l=o.substring(this.CRUMB_1_SEP.length).split(this.CRUMB_2_SEP)[0],h=this.getState(l),f={},c=o.substring(o.indexOf(this.CRUMB_2_SEP)+this.CRUMB_2_SEP.length).split(this.CRUMB_1_SEP)[0];c&&(f=i.parseReturnData(c,h));var p=o.indexOf(this.CRUMB_1_SEP,1);o=-1!=p?o.substring(p):"",e||(r.push(new n(f,h,this.getHref(h,f,null),t&&u)),u=!1),e=!1,a++}return r.reverse(),r},t.getState=function(t){if(!t)return null;var e=t.split("-");return u._dialogs[+e[0]]._states[+e[1]]},t.getHref=function(t,e,r){var n={};n[o.stateIdKey]=t.id,!o.combineCrumbTrail&&t.trackCrumbTrail&&s.state&&(n[o.previousStateIdKey]=s.state.id),o.router.supportsDefaults||(e=a.clone(e),a.setDefaults(e,t.defaults));var u={};for(var l in e){var h=e[l];if(null!=h&&h.toString()){var f=i.formatURLObject(l,h,t);h=f.val,o.router.supportsDefaults&&h===t.formattedDefaults[l]||(n[l]=h,u[l]=f.queryStringVal)}}if(!o.combineCrumbTrail&&t.trackCrumbTrail&&s.state){o.trackAllPreviousData&&(r=s.data);var c=i.formatReturnData(s.state,r);c&&(n[o.returnDataKey]=c)}return this.crumbTrailKey&&t.trackCrumbTrail&&(n[o.crumbTrailKey]=this.crumbTrailKey),t.stateHandler.getNavigationLink(t,n,u)},t.getRefreshHref=function(t){return this.getHref(s.state,t,null)},t.crumbTrail=null,t.crumbTrailKey=null,t.CRUMB_1_SEP="4_",t.CRUMB_2_SEP="5_",t}();e.exports=l},{"./Crumb":1,"./NavigationData":5,"./ReturnDataManager":7,"./StateContext":8,"./config/StateInfoConfig":15,"./settings":31}],3:[function(t,e,r){var n=function(){function t(){}return t.prototype.load=function(t){return t},t.prototype.save=function(t){return t},t}();e.exports=n},{}],4:[function(t,e,r){var n=t("./StateContext"),a=t("./StateController"),i=t("./config/Dialog"),o=t("./config/State"),s=t("./config/Transition"),u=t("./config/StateInfoConfig"),l=t("./history/HistoryAction"),h=t("./history/HistoryNavigator"),f=t("./history/HashHistoryManager"),c=t("./history/HTML5HistoryManager"),p=t("./CrumbTrailPersister"),g=t("./StorageCrumbTrailPersister"),v=t("./Crumb"),d=t("./StateHandler"),y=t("./StateRouter"),m=t("./NavigationSettings"),S=t("./routing/Route"),C=t("./routing/Router"),b=t("./settings"),T=function(){function t(){}return t.Dialog=i,t.State=o,t.Transition=s,t.StateInfoConfig=u,t.HistoryAction=l,t.HashHistoryManager=f,t.HTML5HistoryManager=c,t.CrumbTrailPersister=p,t.StorageCrumbTrailPersister=g,t.Crumb=v,t.NavigationSettings=m,t.StateContext=n,t.StateController=a,t.StateHandler=d,t.StateRouter=y,t.Route=S,t.Router=C,t.settings=b,t.start=function(t){b.historyManager.init(),a.navigateLink(t?t:b.historyManager.getCurrentUrl())},t}();h.navigateHistory=function(){n.url!==b.historyManager.getCurrentUrl()&&a.navigateLink(b.historyManager.getCurrentUrl(),!0)},e.exports=T},{"./Crumb":1,"./CrumbTrailPersister":3,"./NavigationSettings":6,"./StateContext":8,"./StateController":9,"./StateHandler":10,"./StateRouter":11,"./StorageCrumbTrailPersister":12,"./config/Dialog":13,"./config/State":14,"./config/StateInfoConfig":15,"./config/Transition":16,"./history/HTML5HistoryManager":24,"./history/HashHistoryManager":25,"./history/HistoryAction":26,"./history/HistoryNavigator":27,"./routing/Route":28,"./routing/Router":29,"./settings":31}],5:[function(t,e,r){var n=function(){function t(){}return t.setDefaults=function(t,e){for(var r in e)null!=t[r]&&t[r].toString()||(t[r]=e[r])},t.clone=function(t){var e={};for(var r in t)e[r]=t[r];return e},t}();e.exports=n},{}],6:[function(t,e,r){var n=t("./StateRouter"),a=t("./history/HashHistoryManager"),i=t("./CrumbTrailPersister"),o=function(){function t(){this.router=new n,this.historyManager=new a,this.crumbTrailPersister=new i,this.stateIdKey="c0",this.previousStateIdKey="c1",this.returnDataKey="c2",this.crumbTrailKey="c3",this.applicationPath="",this.combineCrumbTrail=!1,this.trackAllPreviousData=!0,this.combineArray=!1}return t}();e.exports=o},{"./CrumbTrailPersister":3,"./StateRouter":11,"./history/HashHistoryManager":25}],7:[function(t,e,r){var n=t("./converter/ConverterFactory"),a=t("./settings"),i=function(){function t(){}return t.formatReturnData=function(t,e){var r=[];for(var n in e)if(null!=e[n]&&e[n].toString()){var i=this.formatURLObject(n,e[n],t,!0).val;a.router.supportsDefaults&&i===t.formattedDefaults[n]||r.push(this.encodeUrlValue(n)+this.RET_1_SEP+i)}return r.join(this.RET_3_SEP)},t.decodeUrlValue=function(t){return t.replace(new RegExp("0"+this.SEPARATOR,"g"),this.SEPARATOR)},t.encodeUrlValue=function(t){return t.replace(new RegExp(this.SEPARATOR,"g"),"0"+this.SEPARATOR)},t.formatURLObject=function(t,e,r,a){void 0===a&&(a=!1),a=a||r.trackTypes;var i=r.defaultTypes[t]?r.defaultTypes[t]:"string",o=n.getConverter(e),s=o.convertTo(e),u=s.val,l=s.queryStringVal;return a&&(u=this.encodeUrlValue(u),l&&(l[0]=this.encodeUrlValue(l[0]))),r.trackTypes&&o.name!==i&&(u+=this.RET_2_SEP+o.key,l&&(l[0]=l[0]+this.RET_2_SEP+o.key)),{val:u,queryStringVal:l}},t.parseURLString=function(t,e,r,a,i){void 0===a&&(a=!1),void 0===i&&(i=!1),a=a||r.trackTypes;var o=r.defaultTypes[t]?r.defaultTypes[t]:"string",s="string"==typeof e?e:e[0],u=n.getConverterFromName(o).key;if(r.trackTypes&&s.indexOf(this.RET_2_SEP)>-1){var l=s.split(this.RET_2_SEP);s=l[0],u=l[1]}return a&&(s=this.decodeUrlValue(s)),"string"==typeof e?e=s:e[0]=s,n.getConverterFromKey(u).convertFrom(e,i)},t.parseReturnData=function(t,e){for(var r={},n=t.split(this.RET_3_SEP),a=0;a<n.length;a++){var i=n[a].split(this.RET_1_SEP);r[this.decodeUrlValue(i[0])]=this.parseURLString(this.decodeUrlValue(i[0]),i[1],e,!0)}return r},t.SEPARATOR="_",t.RET_1_SEP="1_",t.RET_2_SEP="2_",t.RET_3_SEP="3_",t}();e.exports=i},{"./converter/ConverterFactory":19,"./settings":31}],8:[function(t,e,r){var n=function(){function t(){}return t.includeCurrentData=function(t,e){if(!e){e=[];for(var r in this.data)e.push(r)}for(var n={},a=0;a<e.length;a++)n[e[a]]=this.data[e[a]];for(var r in t)n[r]=t[r];return n},t.clear=function(t){if(t)this.data[t]=this.state.defaults[t];else for(var e in this.data)this.data[e]=this.state.defaults[e]},t.oldState=null,t.oldDialog=null,t.oldData={},t.previousState=null,t.previousDialog=null,t.previousData={},t.state=null,t.dialog=null,t.data={},t.url=null,t.title=null,t}();e.exports=n},{}],9:[function(t,e,r){var n=t("./CrumbTrailManager"),a=t("./history/HistoryAction"),i=t("./NavigationData"),o=t("./ReturnDataManager"),s=t("./settings"),u=t("./StateContext"),l=t("./config/StateInfoConfig"),h=function(){function t(){}return t.setStateContext=function(t,e){try{this.setOldStateContext(),u.state=t,u.url=e,u.dialog=t.parent,u.title=t.title;var r={},a=t.stateHandler.getNavigationData(t,e,r);u.data=this.parseData(a,t,r),u.previousState=null,u.previousDialog=null,u.previousData={},n.crumbTrail=s.crumbTrailPersister.load(a[s.crumbTrailKey]);var i=!!a[s.previousStateIdKey];this.setPreviousStateContext(i,a),n.buildCrumbTrail(i),this.crumbs=n.getCrumbs(!0,s.combineCrumbTrail)}catch(o){throw new Error("The Url is invalid\n"+o.message)}},t.clearStateContext=function(){u.oldState=null,u.oldDialog=null,u.oldData={},u.previousState=null,u.previousDialog=null,u.previousData={},u.state=null,u.dialog=null,u.data={},u.url=null,u.title=null,n.crumbTrail=null,n.crumbTrailKey=null},t.setOldStateContext=function(){u.state&&(u.oldState=u.state,u.oldDialog=u.dialog,u.oldData=i.clone(u.data),i.setDefaults(u.oldData,u.oldState.defaults))},t.setPreviousStateContext=function(t,e){if(t)u.previousState=n.getState(e[s.previousStateIdKey]),u.previousState&&(u.previousDialog=u.previousState.parent),e[s.returnDataKey]&&(u.previousData=o.parseReturnData(e[s.returnDataKey],u.previousState));else{var r=n.getCrumbs(!1).pop();r&&(u.previousState=r.state,u.previousDialog=u.previousState.parent,u.previousData=r.data)}},t.onNavigate=function(t){if(!t[this.NAVIGATE_HANDLER_ID]){var e=this.NAVIGATE_HANDLER_ID+this.navigateHandlerId++;t[this.NAVIGATE_HANDLER_ID]=e,this.navigateHandlers[e]=t}},t.offNavigate=function(t){delete this.navigateHandlers[t[this.NAVIGATE_HANDLER_ID]],delete t[this.NAVIGATE_HANDLER_ID]},t.navigate=function(t,e,r){var n=this.getNavigationLink(t,e);if(null==n)throw new Error("Invalid route data, a mandatory route parameter has not been supplied a value");this._navigateLink(n,this.getNextState(t),!1,r)},t.getNavigationLink=function(t,e){return n.getHref(this.getNextState(t),e,u.data)},t.canNavigateBack=function(t){var e=!1;return t<=this.crumbs.length&&t>0&&(e=!0),e},t.navigateBack=function(t,e){var r=this.getNavigationBackLink(t);if(null==r)throw new Error("Invalid route data, a mandatory route parameter has not been supplied a value");this._navigateLink(r,this.getCrumb(t).state,!1,e)},t.getNavigationBackLink=function(t){return this.getCrumb(t).navigationLink},t.refresh=function(t,e){var r=this.getRefreshLink(t);if(null==r)throw new Error("Invalid route data, a mandatory route parameter has not been supplied a value");this._navigateLink(r,u.state,!1,e)},t.getRefreshLink=function(t){return n.getRefreshHref(t)},t.navigateLink=function(t,e,r){try{var n=s.router.getData(t.split("?")[0]).state}catch(a){throw new Error("The Url is invalid\n"+a.message)}this._navigateLink(t,n,e,r)},t._navigateLink=function(t,e,r,n){void 0===r&&(r=!1),void 0===n&&(n=a.Add);try{var i=u.url,o={},s=e.stateHandler.getNavigationData(e,t,o);s=this.parseData(s,e,o)}catch(l){throw new Error("The Url is invalid\n"+l.message)}var h=this.getNavigateContinuation(i,e,t,n),f=function(){i===u.url&&e.navigating(s,t,h,r)};u.state?u.state.unloading(e,s,t,f,r):e.navigating(s,t,h,r)},t.getNavigateContinuation=function(e,r,n,i){var o=this;return function(l){if(e===u.url){r.stateHandler.navigateLink(u.state,r,n),t.setStateContext(r,n),u.oldState&&u.oldState!==r&&u.oldState.dispose(),r.navigated(u.data,l);for(var h in o.navigateHandlers)n===u.url&&o.navigateHandlers[h](u.oldState,r,u.data);n===u.url&&(i!==a.None&&s.historyManager.addHistory(r,n,i===a.Replace),u.title&&"undefined"!=typeof document&&(document.title=u.title))}}},t.parseData=function(t,e,r){var n={};for(var a in t)a!==s.previousStateIdKey&&a!==s.returnDataKey&&a!==s.crumbTrailKey&&t[a]!==e.formattedDefaults[a]&&(n[a]=o.parseURLString(a,t[a],e,!1,!!r[a]));return i.setDefaults(n,e.defaults),n},t.getNextState=function(t){var e=null;if(u.state&&u.state.transitions[t]&&(e=u.state.transitions[t].to),!e&&l.dialogs[t]&&(e=l.dialogs[t].initial),!e)throw new Error("The action parameter must be a Dialog key or a Transition key that is a child of the current State");return e},t.getCrumb=function(t){if(t>this.crumbs.length||0>=t)throw new Error("The distance parameter must be greater than zero and less than or equal to the number of Crumbs ("+this.crumbs.length+")");return this.crumbs[this.crumbs.length-t]},t.NAVIGATE_HANDLER_ID="navigateHandlerId",t.navigateHandlerId=1,t.navigateHandlers={},t}();e.exports=h},{"./CrumbTrailManager":2,"./NavigationData":5,"./ReturnDataManager":7,"./StateContext":8,"./config/StateInfoConfig":15,"./history/HistoryAction":26,"./settings":31}],10:[function(t,e,r){var n=t("./settings"),a=function(){function t(){}return t.prototype.getNavigationLink=function(t,e,r){void 0===r&&(r={});var a=n.router.getRoute(t,e);if(null==a.route)return null;var i=[];for(var o in e)if(o!==n.stateIdKey&&!a.data[o]){var s=r[o],u=this.urlEncode(t,null,o,!0);if(s)for(var l=0;l<s.length;l++)i.push(u+"="+this.urlEncode(t,o,s[l],!0));else i.push(u+"="+this.urlEncode(t,o,e[o],!0))}return i.length>0&&(a.route+="?"+i.join("&")),a.route},t.prototype.navigateLink=function(t,e,r){},t.prototype.getNavigationData=function(t,e,r){void 0===r&&(r={});var a=e.indexOf("?"),i=0>a?e:e.substring(0,a),o=n.router.getData(i).data;if(o=o?o:{},a>=0)for(var s=e.substring(a+1),u=s.split("&"),l=0;l<u.length;l++){var h=u[l].split("="),f=this.urlDecode(t,null,h[0],!0),c=this.urlDecode(t,f,h[1],!0);r[f]=!0;var p=o[f];p?("string"==typeof p&&(o[f]=p=[p]),p.push(c)):o[f]=c}return o},t.prototype.urlEncode=function(t,e,r,n){return encodeURIComponent(r)},t.prototype.urlDecode=function(t,e,r,n){return decodeURIComponent(r)},t.prototype.truncateCrumbTrail=function(t,e){var r=[];if(t.parent.initial===t)return r;for(var n=0;n<e.length&&e[n].state!==t;n++)r.push(e[n]);return r},t}();e.exports=a},{"./settings":31}],11:[function(t,e,r){var n=t("./routing/Router"),a=function(){function t(){this.supportsDefaults=!0}return t.prototype.getData=function(e){var r=this.router.match(e,t.urlDecode);return{state:r.route._state,data:r.data}},t.prototype.getRoute=function(e,r){var n=e._routeInfo,a="";for(var i in n.params)r[i]&&(a+=n.params[i]+",");a=a.slice(0,-1);var o=n.matches[a],s=null;if(o)s=o.route.build(r,t.urlEncode);else{var u=t.findBestMatch(n.routes,r);u&&(s=u.routePath,o={route:u.route,data:u.data},n.matches[a]=o)}return{route:s,data:o?o.data:{}}},t.findBestMatch=function(e,r){for(var n,a=-1,i=0;i<e.length;i++){var o=e[i],s=o.build(r,t.urlEncode);if(s){for(var u=0,l={},h=0;h<o.params.length;h++)r[o.params[h].name]&&(l[o.params[h].name]={},u++);u>a&&(n={route:o,data:l,routePath:s},a=u)}}return n},t.urlEncode=function(t,e,r){var n=t._state;return n.stateHandler.urlEncode?n.stateHandler.urlEncode(n,e,r,!1):encodeURIComponent(r)},t.urlDecode=function(t,e,r){var n=t._state;return n.stateHandler.urlDecode?n.stateHandler.urlDecode(n,e,r,!1):decodeURIComponent(r)},t.prototype.addRoutes=function(t){this.router=new n;for(var e=0;e<t.length;e++)for(var r=0;r<t[e]._states.length;r++)this.addStateRoutes(t[e]._states[r]);this.router.sort(function(t,e){var r="{"===t.path.charAt(0)?-1:0,n="{"===e.path.charAt(0)?-1:0;return n-r})},t.prototype.addStateRoutes=function(e){for(var r={routes:[],params:{},matches:{}},n=0,a=t.getRoutes(e),i=0;i<a.length;i++){for(var o=this.router.addRoute(a[i],e.formattedDefaults),s=0;s<o.params.length;s++){var u=o.params[s];r.params[u.name]||(r.params[u.name]=n,n++)}r.routes.push(o),o._state=e}e._routeInfo=r},t.getRoutes=function(t){var e=[],r=t.route;if("string"==typeof r)e.push(r);else for(var n=0;n<r.length;n++)e.push(r[n]);return e},t}();e.exports=a},{"./routing/Router":29}],12:[function(t,e,r){var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("./CrumbTrailPersister"),i=t("./StateContext"),o=t("./settings"),s=function(t){function e(e,r,n){if(void 0===e&&(e=500),void 0===r&&(r=100),t.call(this),o.combineCrumbTrail=!0,this.maxLength=e,this.historySize=r,this.storage=n,!this.storage)try{localStorage.setItem("CrumbTrail","CrumbTrail"),localStorage.removeItem("CrumbTrail"),this.storage=localStorage}catch(a){this.storage=new u}}return n(e,t),e.prototype.load=function(t){if(!t)return t;if(t&&t.match(/^[a-z]/i)){var e=t.match(/[a-z]\d*/gi),r=this.storage.getItem("CrumbTrail"+e[2]);return r&&0===r.indexOf(e[0]+e[1]+"=")?r.substring(r.indexOf("=")+1):null}return t},e.prototype.save=function(t){if(!t)return t;if(t.length>this.maxLength){var r=0;null!=this.storage.getItem("CrumbTrailCount")&&(r=+this.storage.getItem("CrumbTrailCount"));var n=e.toCode(i.dialog.index),a=e.toCode(i.state.index),o=e.toCode(r%(10*this.historySize));if(r>=this.historySize){var s=e.toCode((r-this.historySize)%(10*this.historySize));this.storage.removeItem("CrumbTrail"+s)}return this.storage.setItem("CrumbTrail"+o,n+a+"="+t),this.storage.setItem("CrumbTrailCount",(r+1).toString()),n+a+o}return t},e.toCode=function(t){var e=t%52,r=Math.floor(t/52);return String.fromCharCode((26>e?97:39)+e)+(r?r.toString():"")},e}(a),u=function(){function t(){this.store={}}return t.prototype.clear=function(){throw new Error("Not implemented")},t.prototype.key=function(t){throw new Error("Not implemented")},t.prototype.getItem=function(t){return this.store[t]},t.prototype.setItem=function(t,e){this.store[t]=e},t.prototype.removeItem=function(t){delete this.store[t]},t}();e.exports=s},{"./CrumbTrailPersister":3,"./StateContext":8,"./settings":31}],13:[function(t,e,r){var n=function(){function t(){this._states=[],this.states={}}return t}();e.exports=n},{}],14:[function(t,e,r){var n=t("../StateHandler"),a=function(){function t(){this._transitions=[],this.transitions={},this.defaults={},this.defaultTypes={},this.formattedDefaults={},this.trackCrumbTrail=!0,this.trackTypes=!0,this.stateHandler=new n,this.unloading=function(t,e,r,n){n()},this.navigating=function(t,e,r){r()},this.dispose=function(){},this.navigated=function(t){}}return t}();e.exports=a},{"../StateHandler":10}],15:[function(t,e,r){var n=t("./Dialog"),a=t("../converter/ConverterFactory"),i=t("../ReturnDataManager"),o=t("../settings"),s=t("./State"),u=t("./Transition"),l=function(){function t(){}return t.build=function(t){this._dialogs=[],this.dialogs={};for(var e=0;e<t.length;e++){var r=t[e],a=new n;a.index=e;for(var i in r)"states"!==i&&(a[i]=r[i]);if(!a.key)throw new Error("key is mandatory for a Dialog");if(this.dialogs[a.key])throw new Error("A Dialog with key "+a.key+" already exists");if(this._dialogs.push(a),this.dialogs[a.key]=a,this.processStates(a,r),this.processTransitions(a,r),a.initial=a.states[r.initial],!r.initial)throw new Error("initial is mandatory for a Dialog");if(!a.initial)throw new Error(a.key+" Dialog's initial key of "+r.initial+" does not match a child State key")}o.router.addRoutes(this._dialogs)},t.processStates=function(t,e){for(var r=0;r<e.states.length;r++){var n=e.states[r],o=new s;o.parent=t,o.index=r,o.id=t.index+"-"+o.index;for(var u in n)"transitions"!==u&&(o[u]=n[u]);for(var u in o.defaults)o.defaultTypes[u]||(o.defaultTypes[u]=a.getConverter(o.defaults[u]).name),o.formattedDefaults[u]=i.formatURLObject(u,o.defaults[u],o).val;for(var u in o.defaultTypes)a.getConverterFromName(o.defaultTypes[u]);if(!o.key)throw new Error("key is mandatory for a State");if(t.states[o.key])throw new Error("A State with key "+o.key+" already exists for Dialog "+t.key);t._states.push(o),t.states[o.key]=o}},t.processTransitions=function(t,e){for(var r=0;r<e.states.length;r++)if(e.states[r].transitions)for(var n=0;n<e.states[r].transitions.length;n++){var a=e.states[r].transitions[n],i=new u;if(i.index=n,i.key=a.key,!i.key)throw new Error("key is mandatory for a Transition");if(i.parent=t._states[r],i.to=t.states[a.to],!a.to)throw new Error("to is mandatory for a Transition");if(!i.to)throw new Error(t._states[r].key+" State's Transition to key of "+i.key+" does not match a sibling State key");if(i.parent.transitions[i.key])throw new Error("A Transition with key "+i.key+" already exists for State "+t._states[r].key);i.parent._transitions.push(i),i.parent.transitions[i.key]=i}},t._dialogs=[],t.dialogs={},t}();e.exports=l},{"../ReturnDataManager":7,"../converter/ConverterFactory":19,"../settings":31,"./Dialog":13,"./State":14,"./Transition":16}],16:[function(t,e,r){var n=function(){function t(){}return t}();e.exports=n},{}],17:[function(t,e,r){var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("../settings"),i=t("./TypeConverter"),o=function(t){function e(e,r){t.call(this,r,e.name+"array"),this.converter=e}return n(e,t),e.prototype.convertFrom=function(t,r){var n=[];if("string"==typeof t)if(!r||a.combineArray)for(var i=t.split(e.SEPARATOR1),o=0;o<i.length;o++)0!==i[o].length?n.push(this.converter.convertFrom(i[o].replace(new RegExp(e.SEPARATOR2,"g"),e.SEPARATOR))):n.push(null);else n.push(this.converter.convertFrom(t));else for(var o=0;o<t.length;o++)0!==t[o].length?n.push(this.converter.convertFrom(t[o])):n.push(null);return n},e.prototype.convertTo=function(t){for(var r=[],n=[],i=0;i<t.length;i++)if(null!=t[i]&&t[i].toString()){var o=this.converter.convertTo(t[i]).val;n.push(o),r.push(o.replace(new RegExp(e.SEPARATOR,"g"),e.SEPARATOR2))}else n.push(""),r.push("");return{val:r.join(e.SEPARATOR1),queryStringVal:a.combineArray?null:n}},e.SEPARATOR="-",e.SEPARATOR1="1-",e.SEPARATOR2="2-",e}(i);e.exports=o},{"../settings":31,"./TypeConverter":23}],18:[function(t,e,r){var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("./TypeConverter"),i=function(t){function e(e){t.call(this,e,"boolean")}return n(e,t),e.prototype.convertFrom=function(t){if("true"!==t&&"false"!==t)throw Error(t+" is not a valid boolean");return"true"===t},e.prototype.convertTo=function(t){return{val:t.toString()}},e}(a);e.exports=i},{"./TypeConverter":23}],19:[function(t,e,r){for(var n=t("./ArrayConverter"),a=t("./BooleanConverter"),i=t("./DateConverter"),o=t("./NumberConverter"),s=t("./StringConverter"),u=t("./TypeConverter"),l={},h={},f=[new s("0"),new a("1"),new o("2"),new i("3")],c=0;c<f.length;c++){var p=f[c],g=new n(p,"a"+p.key);l[p.key]=p,l[g.key]=g,h[p.name]=p.key,h[g.name]=g.key}var v=function(){function t(){}return t.getConverter=function(t){return this.getConverterFromName(u.getName(t))},t.getConverterFromKey=function(t){return l[t]},t.getConverterFromName=function(t){var e=h[t];if(!e)throw new Error("No TypeConverter found for "+t);return this.getConverterFromKey(e)},t}();e.exports=v},{"./ArrayConverter":17,"./BooleanConverter":18,"./DateConverter":20,"./NumberConverter":21,"./StringConverter":22,"./TypeConverter":23}],20:[function(t,e,r){var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("./TypeConverter"),i=function(t){function e(e){t.call(this,e,"date")}return n(e,t),e.prototype.convertFrom=function(t){var e=t.split("-");if(3!==e.length)throw Error(t+" is not a valid date");var r=new Date(+e[0],+e[1]-1,+e[2]);if(isNaN(+r))throw Error(t+" is not a valid date");return r},e.prototype.convertTo=function(t){var e=t.getFullYear(),r=("0"+(t.getMonth()+1)).slice(-2),n=("0"+t.getDate()).slice(-2);return{val:e+"-"+r+"-"+n}},e}(a);e.exports=i},{"./TypeConverter":23}],21:[function(t,e,r){var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("./TypeConverter"),i=function(t){function e(e){t.call(this,e,"number")}return n(e,t),e.prototype.convertFrom=function(t){if(isNaN(+t))throw Error(t+" is not a valid number");return+t},e.prototype.convertTo=function(t){return{val:t.toString()}},e}(a);e.exports=i},{"./TypeConverter":23}],22:[function(t,e,r){var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("./TypeConverter"),i=function(t){function e(e){t.call(this,e,"string")}return n(e,t),e.prototype.convertFrom=function(t){if("string"!=typeof t)throw Error(t+" is not a valid string");return t},e.prototype.convertTo=function(t){return{val:t.toString()}},e}(a);e.exports=i},{"./TypeConverter":23}],23:[function(t,e,r){var n=function(){function t(t,e){this.key=t,this.name=e}return t.prototype.convertFrom=function(t,e){return void 0===e&&(e=!1),null},t.prototype.convertTo=function(t){return null},t.getTypeName=function(t){var e=Object.prototype.toString.call(t);return e.substring(8,e.length-1).toLowerCase()},t.getName=function(t){var e=this.getTypeName(t);if("array"===e){for(var r=t,n="string",a=0;a<r.length;a++)if(null!=r[a]&&r[a].toString()){n=this.getTypeName(r[a]);break}e=n+e}return e},t}();e.exports=n},{}],24:[function(t,e,r){var n=t("./HistoryNavigator"),a=t("../settings"),i=t("../StateContext"),o=function(){function t(){this.disabled="undefined"==typeof window||!(window.history&&window.history.pushState)}return t.prototype.init=function(){this.disabled||window.addEventListener("popstate",n.navigateHistory)},t.prototype.addHistory=function(t,e,r){e=null!=e?e:i.url,e=a.applicationPath+e,this.disabled||location.pathname+location.search===e||(r?window.history.replaceState(null,null,e):window.history.pushState(null,null,e))},t.prototype.getCurrentUrl=function(){return location.pathname.substring(a.applicationPath.length)+location.search},t.prototype.getHref=function(t){if(!t)throw new Error("The Url is invalid");return a.applicationPath+t},t.prototype.getUrl=function(t){return t.pathname.substring(a.applicationPath.length)+t.search},t}();e.exports=o},{"../StateContext":8,"../settings":31,"./HistoryNavigator":27}],25:[function(t,e,r){var n=t("./HistoryNavigator"),a=t("../StateContext"),i=function(){function t(){this.disabled="undefined"==typeof window||!("onhashchange"in window),this.replaceQueryIdentifier=!1}return t.prototype.init=function(){this.disabled||(window.addEventListener?window.addEventListener("hashchange",n.navigateHistory):window.attachEvent("onhashchange",n.navigateHistory))},t.prototype.addHistory=function(t,e,r){e=null!=e?e:a.url,e="#"+this.encode(e),this.disabled||location.hash===e||(r?location.replace(e):location.hash=e)},t.prototype.getCurrentUrl=function(){return this.decode(location.hash.substring(1))},t.prototype.getHref=function(t){if(!t)throw new Error("The Url is invalid");return"#"+this.encode(t)},t.prototype.getUrl=function(t){return this.decode(t.hash.substring(1))},t.prototype.encode=function(t){return this.replaceQueryIdentifier?t.replace("?","#"):t},t.prototype.decode=function(t){return this.replaceQueryIdentifier?t.replace("#","?"):t},t}();e.exports=i},{"../StateContext":8,"./HistoryNavigator":27}],26:[function(t,e,r){var n;!function(t){t[t.Add=0]="Add",t[t.Replace=1]="Replace",t[t.None=2]="None"}(n||(n={})),e.exports=n},{}],27:[function(t,e,r){var n=function(){function t(){}return t}();e.exports=n},{}],28:[function(t,e,r){var n=t("./Segment"),a=function(){function t(t,e){this.segments=[],this.params=[],this.path=t,this.defaults=e?e:{},this.parse()}return t.prototype.parse=function(){for(var t,e=this.path.split("/").reverse(),r="",a=0;a<e.length;a++){t=new n(e[a],t?t.optional:!0,this.defaults),this.segments.unshift(t),r=t.pattern+r;for(var i=[],o=0;o<t.params.length;o++)i.push({name:t.params[o],optional:t.optional});this.params=i.concat(this.params)}this.pattern=new RegExp("^"+r+"$","i")},t.prototype.match=function(t,e){e||(e=function(t,e,r){return decodeURIComponent(r)});var r=this.pattern.exec(t);if(!r)return null;for(var n={},a=1;a<r.length;a++){var i=this.params[a-1];r[a]&&(n[i.name]=e(this,i.name,i.optional?r[a].substring(1):r[a]))}return n},t.prototype.build=function(t,e){var r=this;e||(e=function(t,e,r){return encodeURIComponent(r)}),t=null!=t?t:{};for(var n="",a=!0,i=this.segments.length-1;i>=0;i--){var o=this.segments[i],s=o.build(t,function(t,n){return e(r,t,n)});if(a=a&&s.optional,!a){if(null==s.path)return null;n="/"+s.path+n}}return 0!==n.length?n:"/"},t}();e.exports=a},{"./Segment":30}],29:[function(t,e,r){var n=t("./Route"),a=function(){function t(){this.routes=[]}return t.prototype.addRoute=function(t,e){t="/"===t.slice(-1)?t.substring(0,t.length-1):t,t="/"===t.substring(0,1)?t.substring(1):t;var r=new n(t,e);return this.routes.push(r),r},t.prototype.match=function(t,e){t="/"===t.slice(-1)?t.substring(0,t.length-1):t,t="/"===t.substring(0,1)||0===t.length?t:"/"+t;for(var r=0;r<this.routes.length;r++){var n=this.routes[r],a=n.match(t,e);if(a)return{route:n,data:a}}return null},t.prototype.sort=function(t){this.routes.sort(t)},t}();e.exports=a},{"./Route":28}],30:[function(t,e,r){var n=function(){function t(t,e,r){this.pattern="",this.params=[],this.subSegments=[],this.subSegmentPattern=/[{]{0,1}[^{}]+[}]{0,1}/g,this.escapePattern=/[\.+*\^$\[\](){}']/g,this.path=t,this.optional=e,this.defaults=r,this.parse()}return t.prototype.parse=function(){if(0!==this.path.length){for(var t=this.path.match(this.subSegmentPattern),e=0;e<t.length;e++){var r=t[e];if("{"==r.charAt(0)){var n=r.substring(1,r.length-1),a="?"===n.slice(-1)?n.slice(0,-1):n;this.params.push(a),this.subSegments.push({name:a,param:!0});var i="?"===n.slice(-1)||this.defaults[a];this.optional=this.optional&&this.path.length===r.length&&i,this.pattern+=this.optional?"(/[^/]+)?":"([^/]+)"}else this.optional=!1,this.subSegments.push({name:r,param:!1}),this.pattern+=r.replace(this.escapePattern,"\\$&")}this.optional||(this.pattern="/"+this.pattern)}},t.prototype.build=function(t,e){for(var r="",n=this.optional,a=!1,i=0;i<this.subSegments.length;i++){var o=this.subSegments[i];if(o.param){var s=t[o.name],u=this.defaults[o.name];n=n&&(!s||s===u),s=s?s:u,a=a||!s,s&&(r+=e(o.name,s))}else r+=o.name}return{path:a?null:r,optional:n}},t}();e.exports=n},{}],31:[function(t,e,r){var n=t("./NavigationSettings"),a=new n;e.exports=a},{"./NavigationSettings":6}]},{},[4])(4)});