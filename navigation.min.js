/**
 * Navigation v2.0.0
 * (c) Graham Mendick - http://grahammendick.github.io/navigation/
 * License: Apache-2.0
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Navigation=t()}}(function(){return function t(e,r,n){function a(i,s){if(!r[i]){if(!e[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(o)return o(i,!0);var h=new Error("Cannot find module '"+i+"'");throw h.code="MODULE_NOT_FOUND",h}var l=r[i]={exports:{}};e[i][0].call(l.exports,function(t){var r=e[i][1][t];return a(r?r:t)},l,l.exports,t,e,r,n)}return r[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(t,e,r){"use strict";var n=t("./StateContext"),a=t("./StateNavigator"),o=t("./config/State"),i=t("./history/HashHistoryManager"),s=t("./history/HTML5HistoryManager"),u=t("./config/Crumb"),h=function(){function t(){}return t.State=o,t.HashHistoryManager=i,t.HTML5HistoryManager=s,t.Crumb=u,t.StateContext=n,t.StateNavigator=a,t}();e.exports=h},{"./StateContext":4,"./StateNavigator":6,"./config/Crumb":8,"./config/State":9,"./history/HTML5HistoryManager":17,"./history/HashHistoryManager":18}],2:[function(t,e,r){"use strict";var n=function(){function t(){}return t.formatData=function(t,e,r,n){var a={},o={};for(var i in r){var s=r[i];null!=s&&s.toString()&&this.formatDataItem(t,e,i,s,a,o)}return e.trackCrumbTrail&&n.length>0&&this.formatDataItem(t,e,e.crumbTrailKey,n,a,o),{data:a,arrayData:o}},t.formatDataItem=function(t,e,r,n,a,o){var i=this.formatURLObject(t,r,n,e);n=i.val,n!==e.formattedDefaults[r]&&(a[r]=n,o[r]=i.arrayVal)},t.decodeUrlValue=function(t){return t.replace(new RegExp("0"+this.SEPARATOR,"g"),this.SEPARATOR)},t.encodeUrlValue=function(t){return t.replace(new RegExp(this.SEPARATOR,"g"),"0"+this.SEPARATOR)},t.formatURLObject=function(t,e,r,n,a){void 0===a&&(a=!1),a=a||n.trackTypes;var o=n.defaultTypes[e]?n.defaultTypes[e]:"string",i=t.getConverter(r),s=i.convertTo(r),u=s.val,h=s.arrayVal;return a&&(u=this.encodeUrlValue(u),h&&(h[0]=this.encodeUrlValue(h[0]))),n.trackTypes&&i.name!==o&&(u+=this.SEPARATOR1+i.key,h&&(h[0]=h[0]+this.SEPARATOR1+i.key)),{val:u,arrayVal:h}},t.parseData=function(t,e,r,n){var a={};for(var o in e)this.isDefault(o,e,r,!!n[o])||(a[o]=this.parseURLString(t,o,e[o],r,!1,!!n[o]));for(var o in r.defaults)null!=a[o]&&a[o].toString()||(a[o]=r.defaults[o]);return a},t.isDefault=function(t,e,r,n){var a=e[t],o=r.formattedArrayDefaults[t];if(n&&o){if("string"==typeof a&&(a=[a]),a.length!==o.length)return!1;for(var i=0;i<a.length;i++)if(a[i]!==o[i])return!1;return!0}return a===r.formattedDefaults[t]},t.parseURLString=function(t,e,r,n,a,o){void 0===a&&(a=!1),void 0===o&&(o=!1),a=a||n.trackTypes;var i=n.defaultTypes[e]?n.defaultTypes[e]:"string",s="string"==typeof r?r:r[0],u=t.getConverterFromName(i).key;if(n.trackTypes&&s.indexOf(this.SEPARATOR1)>-1){var h=s.split(this.SEPARATOR1);s=h[0],u=h[1]}return a&&(s=this.decodeUrlValue(s)),"string"==typeof r?r=s:r[0]=s,t.getConverterFromKey(u).convertFrom(r,o)},t.SEPARATOR="_",t.SEPARATOR1="1_",t}();e.exports=n},{}],3:[function(t,e,r){"use strict";var n=t("./NavigationDataManager"),a=t("./config/State"),o=function(){function t(){}return t.build=function(t,e){for(var r=[],o={},i=0;i<t.length;i++){var s=t[i],u=new a;for(var h in s)u[h]=s[h];if(!u.key)throw new Error("State key is mandatory");if(null==u.route&&(u.route=u.key),u.trackCrumbTrail){u.trackCrumbTrail=!0;var l=s.trackCrumbTrail;"string"==typeof l&&(u.crumbTrailKey=l),u.defaultTypes[u.crumbTrailKey]="stringarray"}for(var h in u.defaults){u.defaultTypes[h]||(u.defaultTypes[h]=e.getConverter(u.defaults[h]).name);var p=n.formatURLObject(e,h,u.defaults[h],u);u.formattedDefaults[h]=p.val,p.arrayVal&&(u.formattedArrayDefaults[h]=p.arrayVal)}for(var h in u.defaultTypes)e.getConverterFromName(u.defaultTypes[h]);if(o[u.key])throw new Error("A State with key "+u.key+" already exists");o[u.key]=!0,r.push(u)}return r},t}();e.exports=o},{"./NavigationDataManager":2,"./config/State":9}],4:[function(t,e,r){"use strict";var n=function(){function t(){this.oldState=null,this.oldData={},this.previousState=null,this.previousData={},this.state=null,this.data={},this.url=null,this.title=null,this.crumbs=[],this.crumbTrail=[],this.nextCrumb=null}return t.prototype.clear=function(){this.oldState=null,this.oldData={},this.previousState=null,this.previousData={},this.state=null,this.data={},this.url=null,this.title=null,this.crumbs=[],this.crumbTrail=[],this.nextCrumb=null},t.prototype.includeCurrentData=function(t,e){if(!e){e=[];for(var r in this.data)e.push(r)}for(var n={},a=0;a<e.length;a++)n[e[a]]=this.data[e[a]];for(var r in t)n[r]=t[r];return n},t}();e.exports=n},{}],5:[function(t,e,r){"use strict";var n=function(){function t(){}return t.getNavigationLink=function(t,e,r,n){void 0===n&&(n={});var a=t.getRoute(e,r,n);if(null==a.route)return null;var o=[];for(var i in r)if(!a.data[i]){var s=n[i],u=e.urlEncode(e,null,i,!0);if(s)for(var h=0;h<s.length;h++)o.push(u+"="+e.urlEncode(e,i,s[h],!0));else o.push(u+"="+e.urlEncode(e,i,r[i],!0))}return o.length>0&&(a.route+="?"+o.join("&")),a.route},t.getNavigationData=function(t,e,r){var n=r.indexOf("?"),a=0>n?r:r.substring(0,n),o=t.getData(a),i=o.data,s=o.separableData;if(i=i?i:{},n>=0)for(var u=r.substring(n+1),h=u.split("&"),l=0;l<h.length;l++){var p=h[l].split("="),c=e.urlDecode(e,null,p[0],!0),f=e.urlDecode(e,c,p[1],!0);s[c]=!0;var v=i[c];v?("string"==typeof v&&(i[c]=v=[v]),v.push(f)):i[c]=f}return{data:i,separableData:s}},t}();e.exports=n},{}],6:[function(t,e,r){"use strict";var n=t("./converter/ConverterFactory"),a=t("./config/Crumb"),o=t("./history/HashHistoryManager"),i=t("./NavigationDataManager"),s=t("./StateContext"),u=t("./StateConfig"),h=t("./StateHandler"),l=t("./StateRouter"),p=function(){function t(t,e){this.NAVIGATE_HANDLER_ID="navigateHandlerId",this.navigateHandlerId=1,this.navigateHandlers={},this.converterFactory=new n,this.router=new l,this.stateContext=new s,this.states={},t&&this.configure(t,e)}return t.prototype.configure=function(t,e){var r=this;this.historyManager&&this.historyManager.stop(),this.historyManager=e?e:new o,this.historyManager.init(function(){r.stateContext.url!==r.historyManager.getCurrentUrl()&&r.navigateLink(r.historyManager.getCurrentUrl(),void 0,!0)});var n=u.build(t,this.converterFactory);this.states={};for(var a=0;a<n.length;a++)this.states[n[a].key]=n[a];this.router.addRoutes(n)},t.prototype.setStateContext=function(t,e,r){if(this.stateContext.oldState=this.stateContext.state,this.stateContext.oldData=this.stateContext.data,this.stateContext.state=t,this.stateContext.url=r,this.stateContext.title=t.title,this.stateContext.data=e,this.buildCrumbTrail(!1),this.stateContext.previousState=null,this.stateContext.previousData={},this.stateContext.crumbs.length>0){var n=this.stateContext.crumbs.slice(-1)[0];this.stateContext.previousState=n.state,this.stateContext.previousData=n.data}},t.prototype.buildCrumbTrail=function(t){this.stateContext.crumbTrail=[];var e=this.stateContext.data[this.stateContext.state.crumbTrailKey];e&&(this.stateContext.crumbTrail=e),delete this.stateContext.data[this.stateContext.state.crumbTrailKey],this.stateContext.crumbs=this.getCrumbs();var r=this.getLink(this.stateContext.state,this.stateContext.data,[]);if(!r)throw new Error(this.stateContext.state.crumbTrailKey+" cannot be a mandatory route parameter");this.stateContext.nextCrumb=new a(this.stateContext.data,this.stateContext.state,this.stateContext.url,r,!1)},t.prototype.getCrumbs=function(){for(var t=[],e=this.stateContext.crumbTrail.length,r=0;e>r;r++){var n=this.stateContext.crumbTrail[r],o=this.parseLink(n),i=o.state,s=o.data,u=this.getLink(i,s,this.stateContext.crumbTrail.slice(0,r));t.push(new a(s,i,u,n,r+1===e))}return t},t.prototype.onNavigate=function(t){if(t[this.NAVIGATE_HANDLER_ID])throw new Error("Cannot add the same handler more than once");var e=this.NAVIGATE_HANDLER_ID+this.navigateHandlerId++;t[this.NAVIGATE_HANDLER_ID]=e,this.navigateHandlers[e]=t},t.prototype.offNavigate=function(t){delete this.navigateHandlers[t[this.NAVIGATE_HANDLER_ID]],delete t[this.NAVIGATE_HANDLER_ID]},t.prototype.navigate=function(t,e,r){var n=this.getNavigationLink(t,e);if(null==n)throw new Error("Invalid route data, a mandatory route parameter has not been supplied a value");this.navigateLink(n,r)},t.prototype.getNavigationLink=function(t,e){if(!this.states[t])throw new Error(t+" is not a valid State");return this.getLink(this.states[t],e)},t.prototype.getLink=function(t,e,r){if(!r){r=[];var n=this.stateContext.crumbs.slice();this.stateContext.nextCrumb&&n.push(this.stateContext.nextCrumb),n=t.truncateCrumbTrail(t,n);for(var a=0;a<n.length;a++)r.push(n[a].crumblessUrl)}var o=i.formatData(this.converterFactory,t,e,r),s=o.data,u=o.arrayData;return h.getNavigationLink(this.router,t,s,u)},t.prototype.canNavigateBack=function(t){return t<=this.stateContext.crumbs.length&&t>0},t.prototype.navigateBack=function(t,e){var r=this.getNavigationBackLink(t);if(null==r)throw new Error("Invalid route data, a mandatory route parameter has not been supplied a value");this.navigateLink(r,e)},t.prototype.getNavigationBackLink=function(t){if(!this.canNavigateBack(t))throw new Error("The distance parameter must be greater than zero and less than or equal to the number of Crumbs ("+this.stateContext.crumbs.length+")");return this.stateContext.crumbs[this.stateContext.crumbs.length-t].url},t.prototype.refresh=function(t,e){var r=this.getRefreshLink(t);if(null==r)throw new Error("Invalid route data, a mandatory route parameter has not been supplied a value");this.navigateLink(r,e)},t.prototype.getRefreshLink=function(t){return this.getLink(this.stateContext.state,t)},t.prototype.navigateLink=function(t,e,r){var n=this;void 0===e&&(e="add"),void 0===r&&(r=!1);var a=this.stateContext.url,o=this.parseLink(t),i=o.state,s=o.data,u=this.getNavigateContinuation(a,i,s,t,e),h=function(){a===n.stateContext.url&&i.navigating(s,t,u,r)};this.stateContext.state?this.stateContext.state.unloading(i,s,t,h,r):i.navigating(s,t,u,r)},t.prototype.getNavigateContinuation=function(t,e,r,n,a){var o=this;return function(i){if(t===o.stateContext.url){o.setStateContext(e,r,n),o.stateContext.oldState&&o.stateContext.oldState!==e&&o.stateContext.oldState.dispose(),e.navigated(o.stateContext.data,i);for(var s in o.navigateHandlers)n===o.stateContext.url&&o.navigateHandlers[s](o.stateContext.oldState,e,o.stateContext.data);n===o.stateContext.url&&("none"!==a&&o.historyManager.addHistory(n,"replace"===a),o.stateContext.title&&"undefined"!=typeof document&&(document.title=o.stateContext.title))}}},t.prototype.parseLink=function(t){try{var e=this.router.getData(t.split("?")[0]).state,r=h.getNavigationData(this.router,e,t),n=r.data,a=r.separableData;n=i.parseData(this.converterFactory,n,e,a);var o=n[e.crumbTrailKey];if(o)for(var s=0;s<o.length;s++){var u=o[s];if("/"!==u.substring(0,1))throw new Error(u+" is not a valid crumb")}return{state:e,data:n}}catch(l){throw new Error("The Url is invalid\n"+l.message)}},t.prototype.start=function(t){this.navigateLink(t?t:this.historyManager.getCurrentUrl())},t}();e.exports=p},{"./NavigationDataManager":2,"./StateConfig":3,"./StateContext":4,"./StateHandler":5,"./StateRouter":7,"./config/Crumb":8,"./converter/ConverterFactory":12,"./history/HashHistoryManager":18}],7:[function(t,e,r){"use strict";var n=t("./routing/Router"),a=function(){function t(){}return t.prototype.getData=function(e){var r=this.router.match(e,t.urlDecode),n={};if(r.route._splat)for(var a=0;a<r.route.params.length;a++){var o=r.route.params[a];o.splat&&(n[o.name]=!0)}return{state:r.route._state,data:r.data,separableData:n}},t.prototype.getRoute=function(e,r,n){void 0===n&&(n={});var a=e._routeInfo,o="";for(var i in a.params)r[i]&&(o+=a.params[i]+",");o=o.slice(0,-1);var s=a.matches[o],u=null;if(s){var h=t.getCombinedData(s.route,r,n);u=s.route.build(h,t.urlEncode)}else{var l=t.findBestMatch(a.routes,r,n);l&&(u=l.routePath,s={route:l.route,data:l.data},a.matches[o]=s)}return{route:u,data:s?s.data:{}}},t.findBestMatch=function(e,r,n){for(var a,o=-1,i=-1,s=0;s<e.length;s++){var u=e[s],h=t.getCombinedData(u,r,n),l=u.build(h,t.urlEncode);if(l){for(var p=0,c={},f=0;f<u.params.length;f++)h[u.params[f].name]&&(c[u.params[f].name]={},p++);(p>o||p===o&&u.params.length<i)&&(a={route:u,data:c,routePath:l},o=p,i=u.params.length)}}return a},t.getCombinedData=function(t,e,r){if(!t._splat)return e;var n={};for(var a in e)n[a]=e[a];for(var o=0;o<t.params.length;o++){var i=t.params[o],s=r[i.name];i.splat&&s&&(n[i.name]=s)}return n},t.urlEncode=function(t,e,r){var n=t._state;return n.urlEncode?n.urlEncode(n,e,r,!1):encodeURIComponent(r)},t.urlDecode=function(t,e,r){var n=t._state;return n.urlDecode?n.urlDecode(n,e,r,!1):decodeURIComponent(r)},t.prototype.addRoutes=function(t){this.router=new n;for(var e=0;e<t.length;e++)this.addStateRoutes(t[e]);this.router.sort(function(t,e){var r="{"===t.path.charAt(0)?-1:0,n="{"===e.path.charAt(0)?-1:0;return n-r})},t.prototype.addStateRoutes=function(e){for(var r={routes:[],params:{},matches:{}},n=0,a=t.getRoutes(e),o=0;o<a.length;o++){for(var i=this.router.addRoute(a[o],e.formattedDefaults),s=!1,u=0;u<i.params.length;u++){var h=i.params[u];r.params[h.name]||(r.params[h.name]=n,n++),s=s||h.splat}r.routes.push(i),i._state=e,i._splat=s,i.defaults=t.getCombinedData(i,e.formattedDefaults,e.formattedArrayDefaults)}e._routeInfo=r},t.getRoutes=function(e){var r=[],n=e.route;if("string"==typeof n)r=r.concat(t.expandRoute(n));else for(var a=0;a<n.length;a++)r=r.concat(t.expandRoute(n[a]));return r},t.expandRoute=function(t){for(var e=[],r=t.split("+"),n="",a=0;a<r.length;a++)n+=r[a],e.push(n);return e},t}();e.exports=a},{"./routing/Router":20}],8:[function(t,e,r){"use strict";var n=function(){function t(t,e,r,n,a){this.data=t?t:{},this.state=e,this.last=a,this.title=e.title,this.url=r,this.crumblessUrl=n}return t}();e.exports=n},{}],9:[function(t,e,r){"use strict";var n=function(){function t(){this.defaults={},this.defaultTypes={},this.formattedDefaults={},this.formattedArrayDefaults={},this.trackCrumbTrail=!1,this.crumbTrailKey="crumb",this.trackTypes=!0}return t.prototype.unloading=function(t,e,r,n,a){n()},t.prototype.navigating=function(t,e,r,n){r()},t.prototype.dispose=function(){},t.prototype.navigated=function(t,e){},t.prototype.urlEncode=function(t,e,r,n){return encodeURIComponent(r)},t.prototype.urlDecode=function(t,e,r,n){return decodeURIComponent(r)},t.prototype.truncateCrumbTrail=function(t,e){for(var r=[],n=0;n<e.length&&e[n].state!==t;n++)r.push(e[n]);return r},t}();e.exports=n},{}],10:[function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("./TypeConverter"),o=function(t){function e(e,r){t.call(this,r,e.name+"array"),this.converter=e}return n(e,t),e.prototype.convertFrom=function(t,r){var n=[];if("string"==typeof t)if(r)n.push(this.converter.convertFrom(t));else for(var a=t.split(e.SEPARATOR1),o=0;o<a.length;o++)0!==a[o].length?n.push(this.converter.convertFrom(a[o].replace(new RegExp("0"+e.SEPARATOR,"g"),e.SEPARATOR))):n.push(null);else for(var o=0;o<t.length;o++)0!==t[o].length?n.push(this.converter.convertFrom(t[o])):n.push(null);return n},e.prototype.convertTo=function(t){for(var r=[],n=[],a=0;a<t.length;a++)if(null!=t[a]&&t[a].toString()){var o=this.converter.convertTo(t[a]).val;n.push(o),r.push(o.replace(new RegExp(e.SEPARATOR,"g"),"0"+e.SEPARATOR))}else n.push(""),r.push("");return{val:r.join(e.SEPARATOR1),arrayVal:n}},e.SEPARATOR="-",e.SEPARATOR1="1-",e}(a);e.exports=o},{"./TypeConverter":16}],11:[function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("./TypeConverter"),o=function(t){function e(e){t.call(this,e,"boolean")}return n(e,t),e.prototype.convertFrom=function(t){if("true"!==t&&"false"!==t)throw Error(t+" is not a valid boolean");return"true"===t},e.prototype.convertTo=function(t){return{val:t.toString()}},e}(a);e.exports=o},{"./TypeConverter":16}],12:[function(t,e,r){"use strict";var n=t("./ArrayConverter"),a=t("./BooleanConverter"),o=t("./DateConverter"),i=t("./NumberConverter"),s=t("./StringConverter"),u=t("./TypeConverter"),h=function(){function t(){this.keyToConverterList={},this.nameToKeyList={};for(var t=[new s("0"),new a("1"),new i("2"),new o("3")],e=0;e<t.length;e++){var r=t[e],u=new n(r,"a"+r.key);this.keyToConverterList[r.key]=r,this.keyToConverterList[u.key]=u,this.nameToKeyList[r.name]=r.key,this.nameToKeyList[u.name]=u.key}}return t.prototype.getConverter=function(t){return this.getConverterFromName(u.getName(t))},t.prototype.getConverterFromKey=function(t){return this.keyToConverterList[t]},t.prototype.getConverterFromName=function(t){var e=this.nameToKeyList[t];if(!e)throw new Error("No TypeConverter found for "+t);return this.getConverterFromKey(e)},t}();e.exports=h},{"./ArrayConverter":10,"./BooleanConverter":11,"./DateConverter":13,"./NumberConverter":14,"./StringConverter":15,"./TypeConverter":16}],13:[function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("./TypeConverter"),o=function(t){function e(e){t.call(this,e,"date")}return n(e,t),e.prototype.convertFrom=function(t){var e=t.split("-");if(3!==e.length)throw Error(t+" is not a valid date");var r=new Date(+e[0],+e[1]-1,+e[2]);if(isNaN(+r))throw Error(t+" is not a valid date");return r},e.prototype.convertTo=function(t){var e=t.getFullYear(),r=("0"+(t.getMonth()+1)).slice(-2),n=("0"+t.getDate()).slice(-2);return{val:e+"-"+r+"-"+n}},e}(a);e.exports=o},{"./TypeConverter":16}],14:[function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("./TypeConverter"),o=function(t){function e(e){t.call(this,e,"number")}return n(e,t),e.prototype.convertFrom=function(t){if(isNaN(+t))throw Error(t+" is not a valid number");return+t},e.prototype.convertTo=function(t){return{val:t.toString()}},e}(a);e.exports=o},{"./TypeConverter":16}],15:[function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},a=t("./TypeConverter"),o=function(t){function e(e){t.call(this,e,"string")}return n(e,t),e.prototype.convertFrom=function(t){if("string"!=typeof t)throw Error(t+" is not a valid string");return t},e.prototype.convertTo=function(t){return{val:t.toString()}},e}(a);e.exports=o},{"./TypeConverter":16}],16:[function(t,e,r){"use strict";var n=function(){function t(t,e){this.key=t,this.name=e}return t.prototype.convertFrom=function(t,e){return void 0===e&&(e=!1),null},t.prototype.convertTo=function(t){return null},t.getTypeName=function(t){var e=Object.prototype.toString.call(t);return e.substring(8,e.length-1).toLowerCase()},t.getName=function(t){var e=this.getTypeName(t);if("array"===e){for(var r=t,n="string",a=0;a<r.length;a++)if(null!=r[a]&&r[a].toString()){n=this.getTypeName(r[a]);break}e=n+e}return e},t}();e.exports=n},{}],17:[function(t,e,r){"use strict";var n=function(){function t(t){void 0===t&&(t=""),this.applicationPath="",this.disabled="undefined"==typeof window||!(window.history&&window.history.pushState),this.applicationPath=t}return t.prototype.init=function(t){this.navigateHistory=t,this.disabled||window.addEventListener("popstate",this.navigateHistory)},t.prototype.addHistory=function(t,e){var r=this.getHref(t);this.disabled||location.pathname+location.search===r||(e?window.history.replaceState(null,null,r):window.history.pushState(null,null,r))},t.prototype.getCurrentUrl=function(){return location.pathname.substring(this.applicationPath.length)+location.search},t.prototype.getHref=function(t){if(null==t)throw new Error("The Url is invalid");return this.applicationPath+t},t.prototype.getUrl=function(t){return t.pathname.substring(this.applicationPath.length)+t.search},t.prototype.stop=function(){this.disabled||window.removeEventListener("popstate",this.navigateHistory)},t}();e.exports=n},{}],18:[function(t,e,r){"use strict";var n=function(){function t(t){void 0===t&&(t=!1),this.replaceQueryIdentifier=!1,this.disabled="undefined"==typeof window||!("onhashchange"in window),this.replaceQueryIdentifier=t}return t.prototype.init=function(t){this.navigateHistory=t,this.disabled||(window.addEventListener?window.addEventListener("hashchange",this.navigateHistory):window.attachEvent("onhashchange",this.navigateHistory))},t.prototype.addHistory=function(t,e){var r=this.getHref(t);this.disabled||location.hash===r||(e?location.replace(r):location.hash=r)},t.prototype.getCurrentUrl=function(){return this.decode(location.hash.substring(1))},t.prototype.getHref=function(t){if(null==t)throw new Error("The Url is invalid");return"#"+this.encode(t)},t.prototype.getUrl=function(t){return this.decode(t.hash.substring(1))},t.prototype.stop=function(){this.disabled||(window.removeEventListener?window.removeEventListener("hashchange",this.navigateHistory):window.detachEvent("onhashchange",this.navigateHistory))},t.prototype.encode=function(t){return this.replaceQueryIdentifier?t.replace("?","#"):t},t.prototype.decode=function(t){return this.replaceQueryIdentifier?t.replace("#","?"):t},t}();e.exports=n},{}],19:[function(t,e,r){"use strict";var n=t("./Segment"),a=function(){function t(t,e){this.segments=[],this.params=[],this.path=t,this.defaults=e?e:{},this.parse()}return t.prototype.parse=function(){for(var t,e=this.path.split("/").reverse(),r="",a=0;a<e.length;a++){t=new n(e[a],t?t.optional:!0,this.defaults),this.segments.unshift(t),r=t.pattern+r;for(var o=[],i=0;i<t.params.length;i++){var s=t.params[i];o.push({name:s.name,optional:t.optional,splat:s.splat})}this.params=o.concat(this.params)}this.pattern=new RegExp("^"+r+"$","i")},t.prototype.match=function(t,e){e||(e=function(t,e,r){return decodeURIComponent(r)});var r=this.pattern.exec(t);if(!r)return null;for(var n={},a=1;a<r.length;a++){var o=this.params[a-1];if(r[a]){var i=o.optional?r[a].substring(1):r[a];if(-1===i.indexOf("/"))n[o.name]=e(this,o.name,i);else{for(var s=i.split("/"),u=[],h=0;h<s.length;h++)u[h]=e(this,o.name,s[h]);n[o.name]=u}}}return n},t.prototype.build=function(t,e){var r=this;e||(e=function(t,e,r){return encodeURIComponent(r)}),t=null!=t?t:{};for(var n="",a=!0,o=this.segments.length-1;o>=0;o--){var i=this.segments[o],s=i.build(t,this.defaults,function(t,n){return e(r,t,n)});if(a=a&&s.optional,!a){if(null==s.path)return null;n="/"+s.path+n}}return 0!==n.length?n:"/"},t}();e.exports=a},{"./Segment":21}],20:[function(t,e,r){"use strict";var n=t("./Route"),a=function(){function t(){this.routes=[]}return t.prototype.addRoute=function(t,e){t="/"===t.slice(-1)?t.substring(0,t.length-1):t,t="/"===t.substring(0,1)?t.substring(1):t;var r=new n(t,e);return this.routes.push(r),r},t.prototype.match=function(t,e){t="/"===t.slice(-1)?t.substring(0,t.length-1):t,t="/"===t.substring(0,1)||0===t.length?t:"/"+t;for(var r=0;r<this.routes.length;r++){var n=this.routes[r],a=n.match(t,e);if(a)return{route:n,data:a}}return null},t.prototype.sort=function(t){this.routes.sort(t)},t}();e.exports=a},{"./Route":19}],21:[function(t,e,r){"use strict";var n=function(){function t(t,e,r){this.pattern="",this.params=[],this.subSegments=[],this.subSegmentPattern=/[{]{0,1}[^{}]+[}]{0,1}/g,this.escapePattern=/[\.+*\^$\[\](){}']/g,this.path=t,this.optional=e,this.parse(r)}return t.prototype.parse=function(t){if(0!==this.path.length){for(var e=this.path.match(this.subSegmentPattern),r=0;r<e.length;r++){var n=e[r];if("{"===n.slice(0,1)){var a=n.substring(1,n.length-1),o="?"===a.slice(-1),i="*"===a.slice(0,1),s=o?a.slice(0,-1):a;s=i?s.slice(1):s,this.params.push({name:s,splat:i}),this.optional=this.optional&&o&&this.path.length===n.length,this.path.length===n.length&&(o=this.optional),this.subSegments.push({name:s,param:!0,splat:i,optional:o});var u=i?".+":"[^/]+";this.pattern+=this.optional?"(/"+u+")":"("+u+")",this.pattern+=o?"?":""}else this.optional=!1,this.subSegments.push({name:n,param:!1,splat:!1,optional:!1}),this.pattern+=n.replace(this.escapePattern,"\\$&")}this.optional||(this.pattern="/"+this.pattern)}},t.prototype.build=function(t,e,r){for(var n="",a=!1,o=!1,i=0;i<this.subSegments.length;i++){var s=this.subSegments[i];if(s.param){var u=t[s.name],h=e[s.name];if(o=s.optional&&(!u||u===h),(this.optional||!o)&&(u=u?u:h,a=a||!u,u))if(s.splat&&"string"!=typeof u){for(var l=[],i=0;i<u.length;i++)l[i]=r(s.name,u[i]);n+=l.join("/"),"/"===n.slice(-1)&&(n+="/")}else n+=r(s.name,u)}else n+=s.name}return{path:a?null:n,optional:o&&this.optional}},t}();e.exports=n},{}]},{},[1])(1)});